<!DOCTYPE html>
<html lang="EN">
<link href="css/main_style.css" rel="stylesheet" type="text/css">
  <head>

		<meta charset="UTF-8">
		<title>Room Creator</title>
  </head>
  <body>
    <div id="wrap">
      <div id="main">
        <div class="form-box">
          <div class="button-box">
            <button id="post-btn" type="submit" class="room-btn" title="Limit to one click per minute" onclick="clickTimeLimit();">Create room</button>
            <span id="error"></span>            
          </div>
          <div id="room">
          </div>
        </div>
      </div>
    </div>
    <div id="footer">
    Created by M.A.K. Group: &nbsp;&nbsp; Marcin Gasiewicz, Artur Jałocha, Kamil Radzymiński
    </div>
  </body>
  <script type="text/javascript">
  const button = document.getElementById('post-btn');

  button.addEventListener('click', async _ => 
  {
  try {     
      var request = new XMLHttpRequest();
      request.onreadystatechange = function()
      {
        if (this.readyState == 4 && this.status == 200) 
        {
            var resp = JSON.parse(this.responseText);
            var respcut = resp.roomname;
            document.getElementById("room").innerHTML = respcut;
        }
      };
    
    request.open('POST', 'http://margasiewicz.pythonanywhere.com/room', true);
    request.send();
    } 
    catch(err) 
    {
    console.error(`Error: ${err}`);
    }
  });
  </script>
  <script>
  function clickTimeLimit()
  {
    var error = document.getElementById("error") 
    if(document.getElementById("post-btn").disabled==true)
    {

            error.textContent = "Room can be created once per minute" 
            error.style.color = "red"
    }
    document.getElementById("post-btn").textContent = "Disabled for 60s";
    document.getElementById("post-btn").style.background = "grey";
    document.getElementById("post-btn").disabled = true;
    setTimeout('document.getElementById("post-btn").style.background="#8B0000"',60000);
    setTimeout('document.getElementById("post-btn").disabled=false;',60000);
    setTimeout('document.getElementById("post-btn").textContent = "Create room"',60000);


  }
</script>
</html>
